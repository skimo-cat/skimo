// https://entrepyr.eu/map.html
// pirisport.com
var refus = [
   {
      "name":"Refugi de Quatrepins",
      "lat":42.5333626515214,
      "lon":1.084012814635658,
      "id":10,
      "altitud": 2175,
      "guardat": false
   },
   {
      "name":"Refugi Josep Maria Blanc",
      "lat":42.545598145551836,
      "lon":1.0441674349000354,
      "id":11,
      "urls": [
      	"https://www.jmblanc.com/"
      ],
      "altitud": 2350,
      "places": 60,
      "guardat": true
   },
   {
      "name":"Refugi Estany Llong",
      "lat":42.572571381528356,
      "lon":0.9423402320073735,
      "id":16,
      "altitud": 1985,
      "places": 10,
      "guardat": true,
      "lliure": true,
      "description": "La parte libre no está en el mismo refugio. Se llama refugio de La Centraleta i está en la confluencia del río Contraix y el río San Nicolau. Tiene una capacidad de 10 plazas y está equipada con mantas, colchones, radio de emergencia y leña en el porche. Se tiene que coger el agua del río Contraix.",
      "urls": [
      	"http://www.lacentralderefugis.com/refugios/estany-llong/"
      ]
   },
   {
      "name":"Refugi de Besiberri",
      "lat":42.60462398563759,
      "lon":0.8091444873626928,
      "id":23,
      "guardat": false,
      "places": 9,
      "altitud": 2221,
      "urls": [
      	"https://www.feec.cat/fem-muntanya/refugis/refugi/refugi-besiberri/"
      ]
   },
   {
      "name":"Refugi Ventosa i Calvell",
      "lat":42.60537846947978,
      "lon":0.8772413917718874,
      "id":24,
      "urls": [
      	"http://www.refugiventosa.com/ca/"
      ],
      "altitud": 2220,
      "places": 69,
      "guardat": true,
      "lliure": true,
      "description": "El refugi d’emergència és una part annexa al Refugi J. Ventosa i Calvell, l’entrada es troba a la façana Sud. El refugi d’emergència constitueix un element de seguretat molt important en cas de mal temps així com en situació d’accident. Una emissora d’emergència us posarà en contacte amb els bombers. (6 places)",
   },
   {
      "name":"Refugi Matar\u00f3",
      "lat":42.61770532206267,
      "lon":0.9909474936599355,
      "id":25
   },
   {
      "name":"Refugio De Llauset",
      "lat":42.59942285723796,
      "lon":0.6848671428571429,
      "id":30
   },
   {
      "name":"Refugi de Colomers",
      "lat":42.624308336844855,
      "lon":0.9204638209778027,
      "id":32,
      "urls": [
      	"https://www.refugicolomers.com/inici"
      ],
      "altitud": 2135,
      "places": 60,
      "guardat": true,
   },
   {
      "name":"Refugi Restanca",
      "lat":42.634676649949085,
      "lon":0.8546385989253396,
      "id":35,
      "urls": [
      	"http://www.lacentralderefugis.com/refugios/restanca/"
      ],
      "altitud": 2010,
      "guardat": true,
      "places": 80,
      "lliure": true,
      "description": "12 plaçes al refugi no guardat. Equipat amb mantes, matalassos i radio d'emergència."
   },
   {
      "name":"Refugi d'Airoto",
      "lat":42.69666169912554,
      "lon":1.0421583961503473,
      "id":46,
      "guardat": false,
      "places": 12,
      "altitud": 2199,
      "urls": [
      	"https://www.uecgracia.cat/avantatges/xarxa-de-refugis-uec/"
      ]
   },
   {
      "name":"Refugi Mont Roig",
      "lat":42.70590930242538,
      "lon":1.188951352104761,
      "id":47,
      "urls": [
      	"https://www.feec.cat/fem-muntanya/refugis/refugi/refugi-mont-roig-enric-pujol/"
      ],
      "altitud": 2287,
      "places": 9,
      "guardat": false
   },
   {
      "name":"Refugi Montgarri",
      "lat":42.75922118652133,
      "lon":0.9946663071209298,
      "id":62,
      "urls": [
      	"https://www.refugimontgarri.com/"
      ],
      "guardat": true,
      "places": 35
   },
   {
      "name":"Refugi de Baborte",
      "lat":42.6466997977796,
      "lon":1.36225958642729,
      "id":83,
      "places": 8,
      "description": "8 llits, fins a 16 places en cas de necessitat.",
      "guardat": false,
      "lliure": true
   },
   {
      "name":"Refuge Du Fourcat",
      "lat":42.66497618352148,
      "lon":1.4897055057948982,
      "id":85
   },
   {
      "name":"Refugi de Certascan",
      "lat":42.70393433117199,
      "lon":1.3064940637019855,
      "id":89,
      "altitud": 2240,
      "places": 40,
      "urls": [
        "https://www.feec.cat/fem-muntanya/refugis/refugi/refugi-certascan/",
        "http://www.refugicertascan.cat/"
      ],
      "guardat": true
   },
   {
      "name":"Refugi de la Gola",
      "lat":42.68120971378742,
      "lon":1.1711663267326728,
      "id":90,
      "guardat": false,
      "lliure": true
   },
   {
      "name":"Refugi dels Estanys de la Pera",
      "lat":42.45656537803646,
      "lon":1.5989300123921601,
      "id":105,
      "urls": [
         "https://feec.cat/fem-muntanya/refugis/refugi/refugi-estanys-de-la-pera/"
      ],
      "places": 35,
      "guardat": true,
      "description": "En absència de guarda disposa de 4 places, 2 matalassos, 1 taula, 1 banc, 1 estufa de llenya i llenya per fer foc. Llum."
   },
   {
      "name":"Refugi de Malniu",
      "lat":42.464280828905025,
      "lon":1.7860412375130086,
      "id":106,
      "urls": [
      	"http://www.refugimalniu.com/"
      ],
      "guardat": true
   },
   {
      "name":"Refugi de Perafita",
      "lat":42.47970578693533,
      "lon":1.5782039145555598,
      "id":110
   },
   {
      "name":"Refugi Riu dels Orris",
      "lat":42.48505590339661,
      "lon":1.6397358614072666,
      "id":113
   },
   {
      "name":"Refugi de l'Illa",
      "lat":42.494980363472585,
      "lon":1.6564396771148386,
      "id":116,
      "altitud": 2488,
      "urls": [
         "https://www.refugidelilla.ad/"
      ],
      "places": 50,
      "description": "Obertura des del 1er cap de setmana de Juny fins a l’1 de Novembre, i des de l’1 de Desembre fins a l’1 de maig.",
      "guardat": true
   },
   {
      "name":"Refugi de Montmal\u00fas",
      "lat":42.49914397172456,
      "lon":1.6807022989659093,
      "id":117,
      "altitud": 2445,
      "lliure": true,
      "guardat": false,
      "places": 10
   },
   {
      "name":"Refugi de Comapedrosa",
      "lat":42.579025189938534,
      "lon":1.4492248428841505,
      "id":129,
      "altitud": 2260,
      "places": 49,
      "urls": [
         "https://refugicomapedrosa.ad/",
         "https://entrepyr.eu/mountainhut/comapedrosa.html"
      ],
      "description": "Tancat durant la temporada d'hivern.",
      "guardat": true,
   },
   {
      "name":"Refugi del Pla de l'Estany",
      "lat":42.59385686400065,
      "lon":1.4606197011575663,
      "id":130,
      "urls": [
         "https://visitandorra.com/ca/dormir/refugi-pla-de-l-estany/"
      ],
      "altitud": 2050,
      "places": 6,
      "description": "Es tracta d'un refugi no guardat, que està obert tot l'any, tot i que el manteniment s'acostuma a fer durant els mesos d'estiu (neteja, llenya, farmaciola...). Hi ha cobertura per al telèfon mòbil.",
      "guardat": false,
      "lliure": true
   },
   {
      "name":"Refugi de Baiau",
      "lat":42.59750171939603,
      "lon":1.4292438197901687,
      "id":138,
      "urls": [
         "https://www.feec.cat/fem-muntanya/refugis/refugi/refugi-baiau-josep-maria-montfort/"
      ],
      "altitud": 2517,
      "places": 9,
      "description": "9 llits. Fins a 18 places compartint llit. Disposa de mantes, matalassos, i emissora d'emergència.",
      "lliure": true,
      "guardat": false
   },
   {
      "name":"Refugi de Vallferrera",
      "lat":42.62502996481593,
      "lon":1.3881017111188665,
      "id":143,
      "urls": [
         "https://www.feec.cat/fem-muntanya/refugis/refugi/refugi-vallferrera/",
         "https://centralderefugis.com/product/refugi-vallferrera/"
      ],
      "altitud": 1940,
      "places": 44,
      "guardat": true,
      "description": "En absència de guarda: 10 places. 6 matalassos i 6 mantes. Llum."
   },
   {
      "name":"Refugi de Rialb",
      "lat":42.64000122060332,
      "lon":1.5609288247317943,
      "id":146,
      "guardat": false,
      "lliure": true,
      "places": 6,
      "altitud": 1990,
      "urls": [
         "https://visitandorra.com/es/dormir/refugio-de-rialb/"
      ]
   },
   {
      "name":"Refugi de Broate",
      "lat":42.68242976537006,
      "lon":1.3712479074614232,
      "id":149,
      "altitud": 2218,
      "urls": [
         "https://feec.cat/fem-muntanya/refugis/refugi/refugi-broate/"
      ],
      "places": 9,
      "description": "9 llits. Fins a 18 places compartint llit. Disposa de mantes, matalassos, i emissora d'emergència.",
      "lliure": true,
      "guardat": false
   },
   {
      "name":"Refugi de Pinet",
      "lat":42.69123995229882,
      "lon":1.3964015544337176,
      "id":150,
      "urls": [
         "https://www.pyrenees-ariegeoises.com/es/dormir-espanol/todos-los-alojamientos/refuge-du-pinet-1602947",
         "https://refugeetangpinet.ffcam.fr/"
      ],
      "guardat": true,
      "places": 55,
      "altitud": 2240,
      "description": "Guardat de l'1 de juny al 30 de setembre de forma continuada. Primavera amb reserva prèvia."


   },
   {
      "name":"Refugi de Juclar",
      "lat":42.607357803989885,
      "lon":1.7158365673233547,
      "id":173,
      "altitud": 2310,
      "urls": [
         "http://www.refugidejuclar.com/"
      ],
      "guardat": true,
      "lliure": true,
      "description": "El refugi està guardat durant els mesos d'estiu, de l'1 de juny al 30 de setembre, encara que hi ha la possibilitat d'obertura fora d'aquestes dates sota reserva. Quan el refugi está tancat queda habilitada una part lliure annexa, amb capacitat de 6 places.",
      "places": 43
   },
   {
      "name":"Refugi de Camporells",
      "lat":42.621864603235075,
      "lon":2.011137004583804,
      "id":174,
      "urls": [
         "https://www.turisme-pirineusorientals.cat/refuge-des-camporells/formigueres/hcolllar06600034",
         "https://agrepy-mb-prestataire.for-system.com/f101222_fr-.aspx",
      ],
      "places": 19,
      "description": "Refugi guardat entre el 25 de maig i el 30 d'octubre i obert la resta de l'any amb reserva previa",
      "guardat": true
   },
   {
      "name": "Cabana Port d'Urets",
      "lat": 42.78949195705856,
      "lon": 0.926394434008148,
      "id": -1,
      "urls": [],
      "places": 3,
      "description": "Cabana dalt del coll. Restaurada. Amb estufa de llenya.",
      "guardat": false,
      "lliure": true
   }
]

var refusLayer;

var refusIcon = L.icon({
    iconUrl: 'svg/sleep.svg',

    iconSize:     [18, 30], // size of the icon
    iconAnchor:   [10, 25], // point of the icon which will correspond to marker's location
    popupAnchor:  [-3, -30] // point from which the popup should open relative to the iconAnchor
});

function loadRefus() {
	let markers = new Array(refus.length);
	for (let i=0; i<refus.length; i++) {
		let r = refus[i];
		let popup_text = "<section><header><h2 class='peak_names'>" + r.name + "</h2>";

		if (r.places) {
			popup_text += "<div class='refu-people'><img title='Places disponibles' class='refu-people-img' src='img/people.png'>" + r.places + "</div>";
		}
		if (r.altitud !== undefined) {
			popup_text +=  "<a class='peak_height'>(" + r.altitud + "m)</a>";
		}
		
		popup_text += "<header><section><hr>";

		if (r.guardat !== undefined || r.lliure !== undefined) {
			if (r.guardat) {
				popup_text += "<p>Guardat";
				if (r.lliure) {
					popup_text += " (disposa de zona lliure)";
				}
				popup_text += "</p>";
			} else {
				popup_text += "<p>Refugi lliure</p>";
			}
		}

		if (r.description) {
			popup_text += "<p>" + r.description + "</p>";
		}

      if (r.urls !== undefined) {
         popup_text += "<p><h3><b>Informació:</b></h3><ul class='links'>";
         for (x=0; x<r.urls.length; x++) {
            let link = r.urls[x];
            popup_text += "<li><a class='route_link' target='_blank' href='" + link + "'>" + link + "</a></li>";
         }
      }


		markers[i] = L.marker([r.lat, r.lon], {icon: refusIcon}).bindPopup(popup_text);
	}
	refusLayer = L.layerGroup(markers);
}